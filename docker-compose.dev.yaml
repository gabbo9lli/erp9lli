version: '3.8'

services:
  # --- Frontend Service (Vue Development Server) ---
  frontend:
    # Use the default build (assuming it uses Node)
    build:
      context: ./frontend
    container_name: dev_vue_frontend
    
    # Expose the Vue Dev Server port (HMR) to the host machine
    ports:
      - "8080:8080" 
      
    # Mount local code for live updates (hot-reloading)
    volumes:
      - ./frontend:/app
      # Anonymous volume to prevent host's node_modules overwriting container's
      - /app/node_modules 
      
    # Override the default command to start the Vue development server
    # --host 0.0.0.0 makes the server accessible from outside the container
    command: npm run serve -- --host 0.0.0.0
    
    # Links to the app-network defined in docker-compose.yml

  # --- Backend Service (Flask Development Server) ---
  backend:
    # Use a specific Dockerfile that installs development dependencies
    build:
      context: ./backend
      dockerfile: Dockerfile.dev # Assuming you have a file for dev environment
    container_name: dev_flask_backend
    
    # Expose the Flask port to the host machine
    ports:
      - "5000:5000"
      
    # Mount local code for Flask's built-in reloader
    volumes:
      - ./backend:/app
      
    # Set environment variables for debug and reloader
    environment:
      - FLASK_ENV=development
      - FLASK_DEBUG=1 
      - VUE_APP_API_URL=http://localhost:5000/ # For frontend testing outside the container
      
    # Override the default command to run the application with the reloader
    command: python app.py